"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1);!function(){var g=$(".recharge-way-group");4>=g.find("li").length||(g.append('\x3ca href\x3d"javascript:;" class\x3d"more"\x3e\x3cspan\x3e\u67e5\u770b\u66f4\u591a\u652f\u4ed8\u65b9\u5f0f\x3c/span\x3e\x3c/a\x3e'),g.on("click",".more",function(){$(this).find("span");g.toggleClass("open")}))}();$(function(){function g(a){var b,c,d="",f=0;a=parseFloat(a);$(".m-redPackets-bd li").each(function(){b=$(this).attr("redpack-data").split("#");c=parseFloat(b[1]);a>=c&&0<c&&f<c&&(f=c,d=b[0])});$(".m-redPackets-bd li").removeClass("selected");$("#redpackId-"+d).addClass("selected");m()}function p(){redpackInfo=[];$(".m-redPackets-bd li.selected").each(function(){redpackInfo.push($(this).attr("redpack-data"))});return redpackInfo}function m(){var a=0,b=0,c=p();if(0<c.length){redpackId=c.toString();a=redpackId.split(",");for(i=0;i<a.length;i++)rule=a[i].split("#"),b+=parseFloat(rule[2]);a=c.length}$("#rNum").text(a);$("#rMoney").text(b)}var k=$(".recharge-num-ipt"),b=$(".recharge-num").find("li"),l,q="";!function(){var a=$("#rechargeNumIpt").val();g(a);"10"==a?(b.removeClass("active"),b.eq(0).addClass("active")):"20"==a?(b.removeClass("active"),b.eq(1).addClass("active")):"50"==a?(b.removeClass("active"),b.eq(2).addClass("active")):"100"==a?(b.removeClass("active"),b.eq(3).addClass("active")):"200"==a?(b.removeClass("active"),b.eq(4).addClass("active")):b.removeClass("active")}();(function(){var a=$(".m-redPackets-bd").find("li"),b=(a.width()+20)*a.length-20,c=$(".m-redPackets-bd"),d=$(".m-redPackets-bd-inner"),f=d.width();b>f&&c.addClass("show-r-mask");d.on("scroll",function(){f+d.scrollLeft()>=b-1?c.removeClass("show-r-mask"):c.addClass("show-r-mask");0<d.scrollLeft()?c.addClass("show-l-mask"):1>=d.scrollLeft()&&c.removeClass("show-l-mask")})})();b.on("tap",function(){$(".recharge-num-ipt").blur();$(".m-redPackets-bd li").removeClass("selected");l=parseInt($(this).text());k.val(l);$(this).addClass("active").siblings().removeClass("active");g(l)});k.on("input",function(){var a=$(this).val();$(".m-redPackets-bd li").removeClass("selected");g(a);"10"==a?(b.removeClass("active"),b.eq(0).addClass("active")):"20"==a?(b.removeClass("active"),b.eq(1).addClass("active")):"50"==a?(b.removeClass("active"),b.eq(2).addClass("active")):"100"==a?(b.removeClass("active"),b.eq(3).addClass("active")):"200"==a?(b.removeClass("active"),b.eq(4).addClass("active")):b.removeClass("active")});$(".ipt-psw").find("a").on("tap",function(){var a=$(this).parents(".ipt-psw").find("input");"password"==a.attr("type")?a.attr("type","text"):"text"==a.attr("type")&&a.attr("type","password")});$(".btn-recharge").on("click",function(){try{android.umengStatistic("webview_goRecharge")}catch(a){}$(this);$(".pay-for-recharge").show();setTimeout(function(){$(".pay-for-recharge").addClass("recharge-show")},50)});$(".pay-for-recharge").on("click",".btn-block-cancel",function(){$(this).parents(".pay-for-recharge").hide().removeClass("recharge-show")});$(".m-redPackets-bd").on("tap","li",function(){$(".recharge-num-ipt").blur();var a=$('input[name\x3d"rechargeMoney"]').val();$(this).parents(".m-redPackets-bd-inner").trigger("tap");if($(this).hasClass("selected"))$(this).removeClass("selected");else{if(""==a)return $.tips({content:"\u8bf7\u5148\u8f93\u5165\u5145\u503c\u91d1\u989d",stayTime:2E3}),!1;if(isNaN(a)||0>=a)return $.tips({content:"\u5145\u503c\u91d1\u989d\u9519\u8bef",stayTime:2E3}),!1;$(this).addClass("selected");var b=p(),c="";0<b.length&&(c=b.toString());if(""!=c){b=0;c=c.split(",");for(i=0;i<c.length;i++)rule=c[i].split("#"),b+=parseFloat(rule[1]);if(parseFloat(a)<parseFloat(b))return $(this).removeClass("selected"),$.tips({content:"\u5145\u503c\u91d1\u989d\u4e0d\u6ee1\u8db3\u7ea2\u5305\u4f7f\u7528\u6761\u4ef6",stayTime:2E3}),!1}}m()});$("#redpack-alert").on("tap",function(){$("#redpack-alert").hide()});$("#redpack-used").on("tap",function(){$("#redpack-used").hide();window.location.reload()});$("#recharge-limit-confirm").on("click",function(){$("#recharge-limit").hide()});var d=!0,r=0;$("#change_bankid").on("tap",function(){$('#doPayForm input[name\x3d"change_bankid"]').val("1");$("#payYl").trigger("click");try{android.umengStatistic("webview_umpay_changecard")}catch(a){}$("#btn-block-confirm").trigger("tap")});$("#btn-block-confirm").on("tap",function(a){$(".recharge-num-ipt").blur();$(".recharge-num-ipt").val();a=parseFloat($('input[name\x3d"rechargeMoney"]').val());var b=$('input[name\x3d"token"]').val(),c=$('input[name\x3d"redirectPage"]').val(),l=$('input[name\x3d"rechargeWay"]:checked').attr("pay-data"),f=$('input[name\x3d"rechargeWay"]:checked').attr("jsaction"),e=parseFloat($('input[name\x3d"rechargeWay"]:checked').attr("maxmoney")),h=$('input[name\x3d"rechargeWay"]:checked').attr("secredpack"),m=$('input[name\x3d"appVersionCode"]').val();redpackInfo=p();var n="";0<redpackInfo.length&&(n=redpackInfo.toString());try{var k=android.getAppVersion(),t=android.getAppChannel();android.umengStatistic("webview_recharge")}catch(v){t=k=""}if(""==a)return $.tips({content:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d",stayTime:2E3}),!1;if(/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(a)){if(0>=a)return $.tips({content:"\u5145\u503c\u91d1\u989d\u683c\u5f0f\u9519\u8bef",stayTime:2E3}),!1}else return $.tips({content:"\u5145\u503c\u91d1\u989d\u683c\u5f0f\u9519\u8bef",stayTime:2E3}),!1;if(0<e&&a>e)return $("#limit-money").html(e),$("#recharge-limit").show(),$('input[name\x3d"rechargeMoney"]').val(e),g(h),!1;if(""!=n){e=[];h=0;e=n.split(",");for(i=0;i<e.length;i++)rule=e[i].split("#"),h+=parseFloat(rule[1]);if(parseFloat(a)<parseFloat(h))return $("#redpack-alert").show(),!1}if(d){e=new Date;h=e.getTime()-r;if(0<h&&450>h)return!1;r=e.getTime();d=!1;var u=$.loading().loading("mask");$.ajax({type:"post",url:"/app/api/v1/wallet/doRecharge",data:{money:a,token:b,pay_type:l,redirectPage:c,redpackId:n,app_version:k,channel:t},success:function(a){a=$.parseJSON(a);u.loading("hide");!a.data.way||"wftZfbWap"!=a.data.way&&"wftWxWap"!=a.data.way?"llpay"===f&&1==a.status?(d=!0,pay.llpay(a.data,a.token)):"wxpay"===f&&1==a.status?(d=!0,"hjWxWap"==a.data.pay_type?($('#doPayForm input[name\x3d"uid"]').val(a.data.uid),$('#doPayForm input[name\x3d"trade_no"]').val(a.data.trade_no),$('#doPayForm input[name\x3d"money"]').val(a.data.money),$('#doPayForm input[name\x3d"ip"]').val(a.data.ip),$('#doPayForm input[name\x3d"real_name"]').val(a.data.real_name),$('#doPayForm input[name\x3d"id_card"]').val(a.data.id_card),$('#doPayForm input[name\x3d"merId"]').val(a.data.merId),$('#doPayForm input[name\x3d"configId"]').val(a.data.configId),$('#doPayForm input[name\x3d"pay_type"]').val(a.data.pay_type),$('#doPayForm input[name\x3d"refer"]').val(encodeURI(location.href)),$('#doPayForm input[name\x3d"token"]').val(a.data.token),d=!0,$("#doPayForm").submit(),$('#doPayForm input[name\x3d"change_bankid"]').val("0")):pay.wxpay(a.data,a.token),11<=m&&(q=a.data,$("#recharge-completed").show())):"dopayform"===f&&1==a.status?($('#doPayForm input[name\x3d"uid"]').val(a.data.uid),$('#doPayForm input[name\x3d"trade_no"]').val(a.data.trade_no),$('#doPayForm input[name\x3d"money"]').val(a.data.money),$('#doPayForm input[name\x3d"ip"]').val(a.data.ip),$('#doPayForm input[name\x3d"real_name"]').val(a.data.real_name),$('#doPayForm input[name\x3d"id_card"]').val(a.data.id_card),$('#doPayForm input[name\x3d"merId"]').val(a.data.merId),$('#doPayForm input[name\x3d"configId"]').val(a.data.configId),$('#doPayForm input[name\x3d"pay_type"]').val(a.data.pay_type),$('#doPayForm input[name\x3d"refer"]').val(encodeURI(location.href)),$('#doPayForm input[name\x3d"token"]').val(a.data.token),d=!0,$("#doPayForm").submit(),$('#doPayForm input[name\x3d"change_bankid"]').val("0")):"hrefrediect"===f&&1==a.status?(d=!0,window.location.href=a.data):2==a.status?(d=!0,$("#redpack-used").show()):(d=!0,$.tips({content:a.msg,stayTime:2E3})):(d=!0,window.location.href=a.data.code_url)},error:function(){d=!0;u.loading("hide");$.tips({content:"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",stayTime:2E3})}})}});$("#recharge-completed-cancel").on("click",function(){$("#recharge-completed").hide()});$("#recharge-completed-confirm").on("click",function(){if("order"==$('input[name\x3d"redirectPage"]').val())$.ajax({type:"get",url:"/app/wallet/getWalletStatus/"+q,success:function(a){a=$.parseJSON(a);a.status?window.location.href=a.url:window.location.reload()}});else{try{android.goActivity("com.caipiao166.accountmanager.UserRecordActivity")}catch(a){}$("#recharge-completed").hide()}})});