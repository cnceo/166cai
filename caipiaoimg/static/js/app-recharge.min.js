"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1);!function(){var h=$(".recharge-way-group");4>=h.find("li").length||(h.append('\x3ca href\x3d"javascript:;" class\x3d"more"\x3e\x3cspan\x3e\u67e5\u770b\u66f4\u591a\u652f\u4ed8\u65b9\u5f0f\x3c/span\x3e\x3c/a\x3e'),h.on("click",".more",function(){$(this).find("span");h.toggleClass("open")}))}();var paytoken="";$(function(){function h(b){var c,d,e="",f=0;b=parseFloat(b);$(".m-redPackets-bd li").each(function(){c=$(this).attr("redpack-data").split("#");d=parseFloat(c[1]);b>=d&&0<d&&f<d&&(f=d,e=c[0])});$(".m-redPackets-bd li").removeClass("selected");$("#redpackId-"+e).addClass("selected");n()}function q(){redpackInfo=[];$(".m-redPackets-bd li.selected").each(function(){redpackInfo.push($(this).attr("redpack-data"))});return redpackInfo}function n(){var b=0,c=0,d=q();if(0<d.length){redpackId=d.toString();b=redpackId.split(",");for(i=0;i<b.length;i++)rule=b[i].split("#"),c+=parseFloat(rule[2]);b=d.length}$("#rNum").text(b);$("#rMoney").text(c)}var l=$(".recharge-num-ipt"),c=$(".recharge-num").find("li"),m;!function(){var b=$("#rechargeNumIpt").val();h(b);"10"==b?(c.removeClass("active"),c.eq(0).addClass("active")):"20"==b?(c.removeClass("active"),c.eq(1).addClass("active")):"50"==b?(c.removeClass("active"),c.eq(2).addClass("active")):"100"==b?(c.removeClass("active"),c.eq(3).addClass("active")):"200"==b?(c.removeClass("active"),c.eq(4).addClass("active")):c.removeClass("active")}();(function(){var b=$(".m-redPackets-bd").find("li"),c=(b.width()+20)*b.length-20,d=$(".m-redPackets-bd"),e=$(".m-redPackets-bd-inner"),f=e.width();c>f&&d.addClass("show-r-mask");e.on("scroll",function(){f+e.scrollLeft()>=c-1?d.removeClass("show-r-mask"):d.addClass("show-r-mask");0<e.scrollLeft()?d.addClass("show-l-mask"):1>=e.scrollLeft()&&d.removeClass("show-l-mask")})})();c.on("tap",function(){$(".recharge-num-ipt").blur();$(".m-redPackets-bd li").removeClass("selected");m=parseInt($(this).text());l.val(m);$(this).addClass("active").siblings().removeClass("active");h(m)});l.on("input",function(){var b=$(this).val();$(".m-redPackets-bd li").removeClass("selected");h(b);"10"==b?(c.removeClass("active"),c.eq(0).addClass("active")):"20"==b?(c.removeClass("active"),c.eq(1).addClass("active")):"50"==b?(c.removeClass("active"),c.eq(2).addClass("active")):"100"==b?(c.removeClass("active"),c.eq(3).addClass("active")):"200"==b?(c.removeClass("active"),c.eq(4).addClass("active")):c.removeClass("active")});$(".ipt-psw").find("a").on("tap",function(){var b=$(this).parents(".ipt-psw").find("input");"password"==b.attr("type")?b.attr("type","text"):"text"==b.attr("type")&&b.attr("type","password")});$(".btn-recharge").on("click",function(){try{android.umengStatistic("webview_goRecharge")}catch(b){}$(this);$(".pay-for-recharge").show();setTimeout(function(){$(".pay-for-recharge").addClass("recharge-show")},50)});$(".pay-for-recharge").on("click",".btn-block-cancel",function(){$(this).parents(".pay-for-recharge").hide().removeClass("recharge-show")});$(".m-redPackets-bd").on("tap","li",function(){$(".recharge-num-ipt").blur();var b=$('input[name\x3d"rechargeMoney"]').val();$(this).parents(".m-redPackets-bd-inner").trigger("tap");if($(this).hasClass("selected"))$(this).removeClass("selected");else{if(""==b)return $.tips({content:"\u8bf7\u5148\u8f93\u5165\u5145\u503c\u91d1\u989d",stayTime:2E3}),!1;if(isNaN(b)||0>=b)return $.tips({content:"\u5145\u503c\u91d1\u989d\u9519\u8bef",stayTime:2E3}),!1;$(this).addClass("selected");var c=q(),d="";0<c.length&&(d=c.toString());if(""!=d){c=0;d=d.split(",");for(i=0;i<d.length;i++)rule=d[i].split("#"),c+=parseFloat(rule[1]);if(parseFloat(b)<parseFloat(c))return $(this).removeClass("selected"),$.tips({content:"\u5145\u503c\u91d1\u989d\u4e0d\u6ee1\u8db3\u7ea2\u5305\u4f7f\u7528\u6761\u4ef6",stayTime:2E3}),!1}}n()});$("#redpack-alert").on("tap",function(){$("#redpack-alert").hide()});$("#redpack-used").on("tap",function(){$("#redpack-used").hide();window.location.reload()});$("#recharge-limit-confirm").on("click",function(){$("#recharge-limit").hide()});var e=!0,r=0;$("#change_bankid").on("tap",function(){$('#doPayForm input[name\x3d"change_bankid"]').val("1");$("#payYl").trigger("click");try{android.umengStatistic("webview_umpay_changecard")}catch(b){}$("#btn-block-confirm").trigger("tap")});$("#btn-block-confirm").on("tap",function(b){$(".recharge-num-ipt").blur();$(".recharge-num-ipt").val();b=parseFloat($('input[name\x3d"rechargeMoney"]').val());var c=$('input[name\x3d"token"]').val(),d=$('input[name\x3d"redirectPage"]').val(),m=$('input[name\x3d"rechargeWay"]:checked').attr("pay-data"),f=$('input[name\x3d"rechargeWay"]:checked').attr("jsaction"),g=parseFloat($('input[name\x3d"rechargeWay"]:checked').attr("maxmoney")),k=$('input[name\x3d"rechargeWay"]:checked').attr("secredpack"),n=$('input[name\x3d"appVersionCode"]').val();redpackInfo=q();var p="";0<redpackInfo.length&&(p=redpackInfo.toString());try{var l=android.getAppVersion(),t=android.getAppChannel();android.umengStatistic("webview_recharge")}catch(a){t=l=""}if(""==b)return $.tips({content:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d",stayTime:2E3}),!1;if("order"==d)if(/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(b)){if(0>=b)return $.tips({content:"\u5145\u503c\u91d1\u989d\u683c\u5f0f\u9519\u8bef",stayTime:2E3}),!1}else return $.tips({content:"\u5145\u503c\u91d1\u989d\u683c\u5f0f\u9519\u8bef",stayTime:2E3}),!1;else if(/^[1-9][0-9]*$/.test(b)){if(10>parseInt(b))return $.tips({content:"\u8bf7\u81f3\u5c11\u5145\u503c10\u5143",stayTime:2E3}),!1}else return $.tips({content:"\u8bf7\u8f93\u5165\u6574\u6570\u91d1\u989d",stayTime:2E3}),!1;if(0<g&&b>g)return $("#limit-money").html(g),$("#recharge-limit").show(),$('input[name\x3d"rechargeMoney"]').val(g),h(k),!1;if(""!=p){g=[];k=0;g=p.split(",");for(i=0;i<g.length;i++)rule=g[i].split("#"),k+=parseFloat(rule[1]);if(parseFloat(b)<parseFloat(k))return $("#redpack-alert").show(),!1}if(e){g=new Date;k=g.getTime()-r;if(0<k&&450>k)return!1;r=g.getTime();e=!1;var u=$.loading().loading("mask");$.ajax({type:"post",url:"/app/api/v1/wallet/doRecharge",data:{money:b,token:c,pay_type:m,redirectPage:d,redpackId:p,app_version:l,channel:t},success:function(a){a=$.parseJSON(a);u.loading("hide");!a.data.way||"wftZfbWap"!=a.data.way&&"wftWxWap"!=a.data.way&&"yzpay"!=a.data.way?"llpay"===f&&1==a.status?(e=!0,pay.llpay(a.data,a.token)):"wxpay"===f&&1==a.status?(e=!0,"hjWxWap"==a.data.pay_type?($('#doPayForm input[name\x3d"uid"]').val(a.data.uid),$('#doPayForm input[name\x3d"trade_no"]').val(a.data.trade_no),$('#doPayForm input[name\x3d"money"]').val(a.data.money),$('#doPayForm input[name\x3d"ip"]').val(a.data.ip),$('#doPayForm input[name\x3d"real_name"]').val(a.data.real_name),$('#doPayForm input[name\x3d"id_card"]').val(a.data.id_card),$('#doPayForm input[name\x3d"merId"]').val(a.data.merId),$('#doPayForm input[name\x3d"configId"]').val(a.data.configId),$('#doPayForm input[name\x3d"pay_type"]').val(a.data.pay_type),$('#doPayForm input[name\x3d"refer"]').val(encodeURI(location.href)),$('#doPayForm input[name\x3d"token"]').val(a.data.token),e=!0,$("#doPayForm").submit(),$('#doPayForm input[name\x3d"change_bankid"]').val("0")):pay.wxpay(a.data,a.token),11<=n&&(paytoken=a.data,$("#recharge-completed").show())):"jdpay"===f&&1==a.status?(e=!0,"jdPay"==a.data.pay_type?($('#doPayForm input[name\x3d"uid"]').val(a.data.uid),$('#doPayForm input[name\x3d"trade_no"]').val(a.data.trade_no),$('#doPayForm input[name\x3d"money"]').val(a.data.money),$('#doPayForm input[name\x3d"ip"]').val(a.data.ip),$('#doPayForm input[name\x3d"real_name"]').val(a.data.real_name),$('#doPayForm input[name\x3d"id_card"]').val(a.data.id_card),$('#doPayForm input[name\x3d"merId"]').val(a.data.merId),$('#doPayForm input[name\x3d"configId"]').val(a.data.configId),$('#doPayForm input[name\x3d"pay_type"]').val(a.data.pay_type),$('#doPayForm input[name\x3d"refer"]').val(encodeURI(location.href)),$('#doPayForm input[name\x3d"token"]').val(a.data.token),$("#doPayForm").submit(),$('#doPayForm input[name\x3d"change_bankid"]').val("0")):pay.jdpay(a.data,a.token)):"dopayform"===f&&1==a.status?($('#doPayForm input[name\x3d"uid"]').val(a.data.uid),$('#doPayForm input[name\x3d"trade_no"]').val(a.data.trade_no),$('#doPayForm input[name\x3d"money"]').val(a.data.money),$('#doPayForm input[name\x3d"ip"]').val(a.data.ip),$('#doPayForm input[name\x3d"real_name"]').val(a.data.real_name),$('#doPayForm input[name\x3d"id_card"]').val(a.data.id_card),$('#doPayForm input[name\x3d"merId"]').val(a.data.merId),$('#doPayForm input[name\x3d"configId"]').val(a.data.configId),$('#doPayForm input[name\x3d"pay_type"]').val(a.data.pay_type),$('#doPayForm input[name\x3d"refer"]').val(encodeURI(location.href)),$('#doPayForm input[name\x3d"token"]').val(a.data.token),e=!0,$("#doPayForm").submit(),$('#doPayForm input[name\x3d"change_bankid"]').val("0")):"hrefrediect"===f&&1==a.status?(e=!0,window.location.href=a.data):2==a.status?(e=!0,$("#redpack-used").show()):(e=!0,$.tips({content:a.msg,stayTime:2E3})):(e=!0,window.location.href=a.data.code_url)},error:function(){e=!0;u.loading("hide");$.tips({content:"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",stayTime:2E3})}})}});$("#recharge-completed-cancel").on("click",function(){$("#recharge-completed").hide()});$("#recharge-completed-confirm").on("click",function(){if("order"==$('input[name\x3d"redirectPage"]').val())$.ajax({type:"get",url:"/app/wallet/getWalletStatus/"+paytoken,success:function(b){b=$.parseJSON(b);b.status?window.location.href=b.url:window.location.reload()}});else{try{android.goActivity("com.caipiao166.accountmanager.UserRecordActivity")}catch(b){}$("#recharge-completed").hide()}})});